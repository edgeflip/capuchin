{% extends "base.html" %}

{% block title %}Dashboard{% endblock %}

{% block head %}
<script src="/static/vendor/topojson.v1.min.js"></script>
<script src="/static/js/charts/chart.js"></script>

<script>
$(document).ready(function(){
    /*
    $("#charts").usa({
        name:"Users by City",
        data_url:"{{url_for('.chart', chart_id='city_population')}}"
    }).render(8);
    $("#charts").vertical_circle({
        name:"Top Referrers",
        data_url:"{{url_for('.chart', chart_id='referrers')}}"
    }).render(4);
    $("#charts").horizontal_multibar({
        name:"Top Likes",
        data_url:"{{url_for('.chart', chart_id='top_likes')}}"
    }).render(6);
    $("#charts").multibar({
        name:"Page Engagement",
        data_url:"{{url_for('.chart', chart_id='engaged_users')}}"
    }).render(6);
    $("#charts").word_bubble({
        name:"Top Words",
        data_url:"{{url_for('.chart', chart_id='top_words')}}"
    }).render(6);
    $("#charts").stackedline({
        name:"Likes",
        data_url:"{{url_for('.chart', chart_id='likes')}}"
    }).render(6);
    */
    $("#charts").lineplusbar({
        name:"Likes",
        data_url:"{{url_for('.chart', chart_id='like_gains')}}"
    }).render(6);
    /*
    $("#charts").pie({
        name:"Engagement by Story Type",
        data_url:"{{url_for('.chart', chart_id='page_by_type')}}"
    }).render(6);
    $("#charts").pie({
        name:"Engagement by Country",
        data_url:"{{url_for('.chart', chart_id='country')}}"
    }).render(6);
    */

});
</script>
{% endblock %}

{% block content %}
    <div class="row top-level">
        <div class="col-md-3">
            <div class="thumbnail">
                <div class="caption">
                    <h3>Audience</h3>
                    <h3 class="supporters">
                        {{like_change['total']}}
                    </h3>
                    <h3>Supporters</h3>
                    <p>{{"{:.1}".format(like_change['change'])}}% change since last week</p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="thumbnail">
                <div class="caption">
                    <h3>Engagement</h3>
                    <p>{{engagement_change['total']}}</p>
                    <p>{{engagement_change['change']}}% change since last week</p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="thumbnail">
                <div class="caption">
                    <h3>Conversions</h3>
                    <p>...</p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="thumbnail">
                <div class="caption">
                    <h3>Buzz</h3>
                    <p>...</p>
                </div>
            </div>
        </div>
    </div>
    <div class="row" id="charts"></div>
    <div class="row">
        {% if first %}
            <h1>Welcome to Capuchin, let's show you around!</h1>
        {% endif %}
        <div class="col-md-4">
            <h3>Campaigns</h3>
            <table class='table table-striped'>
                <thead>
                    <th>Name</th>
                    <th>Message</th>
                    <th>Users</th>
                    <th>Clicks</th>
                    <th></th>
                </thead>
                <tbody>
                    <tr>
                        <td>Avid readers in California</td>
                        <td>We've got some great new resources for you...</td>
                        <td>5,908</td>
                        <td>2,898</td>
                        <td>
                            <a class='btn btn-primary' href='' role="button">View</a>
                        </td>
                    </tr>
                    <tr>
                        <td>New Website</td>
                        <td>Check out the new site!</td>
                        <td>2,898</td>
                        <td>2,512</td>
                        <td>
                            <a class='btn btn-primary' href='' role="button">View</a>
                        </td>
                    </tr>
                    <tr>
                        <td>Help us help you!</td>
                        <td>Donate now and get a free subscription.</td>
                        <td>6,005</td>
                        <td>3,090</td>
                        <td>
                            <a class='btn btn-primary' href='' role="button">View</a>
                        </td>
                    </tr>
                    <tr>
                        <td>Drama fans in Delaware</td>
                        <td>Delaware loves the Golden Globes.</td>
                        <td>1,309</td>
                        <td>566</td>
                        <td>
                            <a class='btn btn-primary' href='' role="button">View</a>
                        </td>
                    </tr>
                    <tr>
                        <td>Liberals in Detroit</td>
                        <td>Detroit needs you!</td>
                        <td>1,098</td>
                        <td>978</td>
                        <td>
                            <a class='btn btn-primary' href='' role="button">View</a>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="col-md-4">
            <h3>Lists</h3>
            <table class='table table-striped'>
                <thead>
                    <th>Name</th>
                    <th>Users</th>
                    <th></th>
                </thead>
                <tbody>
                    {% for l in lists %}
                    <tr>
                        <td>{{l.name}}</td>
                        <td>{{"{:,}".format(l.users)}}</td>
                        <td>
                            <a class='btn btn-primary' href="{{url_for('lists.index')}}" role="button">View</a>
                            <a class='btn btn-danger' href='' role="button">Share</a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        <div class="col-md-4">
            <h3>Segments</h3>
            <table class='table table-striped'>
                <thead>
                    <th>Name</th>
                    <th>Users</th>
                    <th></th>
                </thead>
                <tbody>
                    {% for s in segments %}
                    <tr>
                        <td>{{s.name}}</td>
                        <td>{{"{:,}".format(s.count)}}</td>
                        <td>
                            <a class='btn btn-primary' href="{{url_for('segments.id', id=s._id|string)}}" role="button">View</a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
{% endblock %}
